name: Test Disk Space

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Linux disk BEFORE cleanup
        run: df -h /

      - name: Free disk space
        uses: jlumbroso/free-disk-space@main
        with:
          tool-cache: true
          android: true
          dotnet: true
          haskell: true
          large-packages: true
          docker-images: true
          swap-storage: false

      - name: Linux disk AFTER cleanup
        run: df -h /

      - name: FreeBSD VM disk
        uses: vmactions/freebsd-vm@v1.3.4
        with:
          release: "15.0"
          usesh: true
          run: |
            echo "=== FreeBSD disk ==="
            df -h
            echo "=== FreeBSD memory ==="
            sysctl hw.physmem hw.usermem
